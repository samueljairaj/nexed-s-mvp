{
  "ruleSet": {
    "name": "OPT Compliance Rules",
    "description": "Intelligent compliance rules for students on Optional Practical Training with real-time unemployment tracking",
    "version": "1.0",
    "lastUpdated": "2025-01-25"
  },
  "rules": [
    {
      "id": "opt-unemployment-tracking",
      "name": "OPT Unemployment Days Alert",
      "description": "Track unemployment days to prevent exceeding 90-day limit",
      "ruleGroup": "employment",
      "phase": ["opt_active"],
      "visaTypes": ["OPT"],
      "priority": 95,
      "conditions": [
        {
          "field": "employment.unemploymentDaysUsed",
          "operator": "greaterThan",
          "value": 60,
          "logicOperator": "AND"
        },
        {
          "field": "employment.status",
          "operator": "equals",
          "value": "unemployed"
        }
      ],
      "taskTemplate": {
        "titleTemplate": "üö® OPT Unemployment Limit Warning ({employment.unemploymentDaysUsed}/90 days used)",
        "descriptionTemplate": "‚ö†Ô∏è **CRITICAL**: You've used {employment.unemploymentDaysUsed} of your 90 allowed unemployment days.\n\nüìä **Your Status**:\n‚Ä¢ Days Used: {employment.unemploymentDaysUsed}/90\n‚Ä¢ Days Remaining: {#unemployment_days_remaining}\n‚Ä¢ Current Status: Unemployed since {dates.lastEmploymentEndDate}\n\nüö® **Immediate Action Required**:\n‚Ä¢ Find employment within {#unemployment_days_remaining} days\n‚Ä¢ Report new job to DSO within 10 days of starting\n‚Ä¢ Consider returning to school if no job prospects\n\nüíº **Job Search Resources**:\n‚Ä¢ University career center\n‚Ä¢ Professional networking events\n‚Ä¢ LinkedIn job alerts\n‚Ä¢ Industry-specific job boards\n\nüìû **DSO Contact**: {user.academic.dsoContact.name}\nüìß **Email**: {user.academic.dsoContact.email}\n\n‚è∞ **Status at Risk**: Exceeding 90 days terminates OPT authorization",
        "category": "employment",
        "priority": "high",
        "dueDateConfig": {
          "type": "calculated",
          "calculation": "unemployment_grace_end"
        }
      },
      "isActive": true,
      "tags": ["unemployment", "critical", "job-search"],
      "version": "1.0"
    },
    {
      "id": "opt-job-reporting",
      "name": "Report New Employment to DSO",
      "description": "New OPT employment must be reported within 10 days",
      "ruleGroup": "reporting",
      "phase": ["opt_active"],
      "visaTypes": ["OPT"],
      "priority": 85,
      "conditions": [
        {
          "field": "employment.newJobStarted",
          "operator": "equals",
          "value": true,
          "logicOperator": "AND"
        },
        {
          "field": "employment.jobReportedToDSO",
          "operator": "equals",
          "value": false
        }
      ],
      "taskTemplate": {
        "titleTemplate": "üìù Report New Job to DSO (Due: {#job_reporting_deadline})",
        "descriptionTemplate": "Congratulations on your new position! Report your employment details to your DSO within 10 days.\n\nüéâ **New Position**:\n‚Ä¢ **Company**: {employment.employer}\n‚Ä¢ **Title**: {employment.jobTitle}\n‚Ä¢ **Start Date**: {dates.employmentStartDate}\n‚Ä¢ **Location**: {employment.workLocation}\n\nüìã **Required Reporting**:\n‚Ä¢ Employer name and address\n‚Ä¢ Job title and duties\n‚Ä¢ Start and end dates\n‚Ä¢ Supervisor contact information\n‚Ä¢ Salary information\n\nüë§ **DSO Contact**: {user.academic.dsoContact.name}\nüìß **Email**: {user.academic.dsoContact.email}\nüìû **Phone**: {user.academic.dsoContact.phone}\n\nüìÑ **How to Report**:\n1. Log into university's international student portal\n2. Submit OPT employment report form\n3. Upload offer letter or employment verification\n4. Save confirmation receipt\n\n‚è∞ **Legal Deadline**: 10 days from start date\nüèõÔ∏è **Regulation**: 8 CFR 214.2(f)(10)(ii)(D)",
        "category": "reporting",
        "priority": "high",
        "dueDateConfig": {
          "type": "relative",
          "baseDate": "dates.employmentStartDate",
          "offset": "+10days"
        }
      },
      "isActive": true,
      "tags": ["employment", "reporting", "dso"],
      "version": "1.0"
    },
    {
      "id": "opt-address-update",
      "name": "Update Address in SEVP Portal",
      "description": "Address changes must be reported within 10 days during OPT",
      "ruleGroup": "reporting",
      "phase": ["opt_active"],
      "visaTypes": ["OPT"],
      "priority": 80,
      "conditions": [
        {
          "field": "flags.addressChangeRecent",
          "operator": "equals",
          "value": true,
          "logicOperator": "AND"
        },
        {
          "field": "location.sevpPortalUpdated",
          "operator": "equals",
          "value": false
        }
      ],
      "taskTemplate": {
        "titleTemplate": "üè† Update Address in SEVP Portal",
        "descriptionTemplate": "You moved to {location.currentAddress}. Update your address in the SEVP Portal within 10 days.\n\nüìç **New Address**:\n{location.currentAddress}\n{location.city}, {location.state} {location.zipCode}\n\nüåê **SEVP Portal Steps**:\n1. Visit studyinthestates.dhs.gov/students\n2. Log in with your SEVIS ID: {user.sevisId}\n3. Navigate to \"Update Information\"\n4. Enter new address details\n5. Submit and save confirmation\n\nüìã **Required Information**:\n‚Ä¢ Complete street address\n‚Ä¢ City, state, ZIP code\n‚Ä¢ Phone number\n‚Ä¢ Email address\n\n‚ö†Ô∏è **Important**: This is separate from university address updates\n\n‚è∞ **Deadline**: {#address_update_deadline}\nüèõÔ∏è **Legal Requirement**: 8 CFR 214.2(f)(10)(ii)(A)",
        "category": "reporting",
        "priority": "high",
        "dueDateConfig": {
          "type": "calculated",
          "calculation": "address_update_deadline"
        }
      },
      "isActive": true,
      "tags": ["address", "sevp-portal", "reporting"],
      "version": "1.0"
    },
    {
      "id": "opt-travel-planning",
      "name": "Plan International Travel Carefully",
      "description": "OPT travel requires specific documents and timing considerations",
      "ruleGroup": "travel",
      "phase": ["opt_active"],
      "visaTypes": ["OPT"],
      "priority": 60,
      "conditions": [
        {
          "field": "flags.planningToTravel",
          "operator": "equals",
          "value": true,
          "logicOperator": "AND"
        },
        {
          "field": "travel.optTravelPrepped",
          "operator": "equals",
          "value": false
        }
      ],
      "taskTemplate": {
        "titleTemplate": "‚úàÔ∏è Prepare for International Travel on OPT",
        "descriptionTemplate": "International travel during OPT requires careful preparation. Ensure you have all required documents.\n\nüìÑ **Required Documents**:\n‚Ä¢ Valid passport (6+ months validity)\n‚Ä¢ Valid F1 visa stamp\n‚Ä¢ Current I-20 with recent travel signature\n‚Ä¢ EAD card (OPT work authorization)\n‚Ä¢ Employment verification letter\n‚Ä¢ Pay stubs (if employed)\n\nüíº **Employment Considerations**:\n‚Ä¢ {?employment.status == 'employed':Notify employer of travel dates:Traveling while unemployed uses unemployment days}\n‚Ä¢ Bring employment verification letter\n‚Ä¢ Consider impact on unemployment day count\n\n‚ö†Ô∏è **Travel Risks**:\n‚Ä¢ Re-entry not guaranteed\n‚Ä¢ Unemployment days continue during travel\n‚Ä¢ Expired documents = denied entry\n‚Ä¢ Processing delays at border\n\nüìÖ **Recommended Timeline**:\n‚Ä¢ Plan travel 4-6 weeks in advance\n‚Ä¢ Get I-20 signed 2 weeks before travel\n‚Ä¢ Confirm all documents are current\n\nüë§ **DSO Consultation**: Recommended before travel",
        "category": "travel",
        "priority": "medium",
        "dueDateConfig": {
          "type": "relative",
          "baseDate": "dates.plannedTravelDate",
          "offset": "-21days"
        }
      },
      "isActive": true,
      "tags": ["travel", "documents", "preparation"],
      "version": "1.0"
    },
    {
      "id": "opt-ead-renewal-check",
      "name": "Monitor EAD Card Expiration",
      "description": "Track EAD card expiration and renewal needs",
      "ruleGroup": "documents",
      "phase": ["opt_active"],
      "visaTypes": ["OPT"],
      "priority": 70,
      "conditions": [
        {
          "field": "dates.eadExpiryDate",
          "operator": "lessThan",
          "timeValue": "90days",
          "logicOperator": "AND"
        },
        {
          "field": "employment.stemOptEligible",
          "operator": "equals",
          "value": true
        }
      ],
      "taskTemplate": {
        "titleTemplate": "üìã EAD Card Expires Soon - Consider STEM Extension",
        "descriptionTemplate": "Your EAD card expires on {dates.eadExpiryDate} ({#days_until_ead_expiry} days). Time to consider STEM OPT extension!\n\nüìä **Your Eligibility**:\n‚Ä¢ **Degree**: {academic.fieldOfStudy}\n‚Ä¢ **STEM Eligible**: {?academic.isSTEM:Yes - You qualify!:Check STEM list}\n‚Ä¢ **Current EAD**: Expires {dates.eadExpiryDate}\n\nüî¨ **STEM OPT Benefits**:\n‚Ä¢ Additional 24 months of work authorization\n‚Ä¢ Apply 90 days before current OPT expires\n‚Ä¢ Must have STEM degree and E-Verify employer\n‚Ä¢ Enhanced training and mentorship requirements\n\nüìã **Next Steps**:\n1. Confirm STEM eligibility with DSO\n2. Secure E-Verify compliant employer\n3. Prepare STEM OPT application\n4. Submit I-765 with STEM documents\n\n‚è∞ **Application Window**:\n‚Ä¢ **Opens**: 90 days before EAD expiry\n‚Ä¢ **Recommended**: Apply within next 30 days\n‚Ä¢ **Latest**: 90 days before expiration\n\nüë§ **DSO Meeting**: Schedule STEM consultation now",
        "category": "employment",
        "priority": "high",
        "dueDateConfig": {
          "type": "relative",
          "baseDate": "dates.eadExpiryDate",
          "offset": "-90days"
        }
      },
      "isActive": true,
      "tags": ["ead", "stem-extension", "renewal"],
      "version": "1.0"
    },
    {
      "id": "opt-job-relationship-verification",
      "name": "Ensure Job Relates to Field of Study",
      "description": "OPT employment must be directly related to academic program",
      "ruleGroup": "employment",
      "phase": ["opt_active"],
      "visaTypes": ["OPT"],
      "priority": 65,
      "conditions": [
        {
          "field": "employment.status",
          "operator": "equals",
          "value": "employed",
          "logicOperator": "AND"
        },
        {
          "field": "employment.fieldRelationshipVerified",
          "operator": "equals",
          "value": false
        }
      ],
      "taskTemplate": {
        "titleTemplate": "üîç Verify Job Relates to Your Field of Study",
        "descriptionTemplate": "Ensure your current position meets OPT requirements for field-related employment.\n\nüéì **Your Academic Background**:\n‚Ä¢ **Degree**: {academic.degreeLevel} in {academic.fieldOfStudy}\n‚Ä¢ **University**: {academic.university}\n\nüíº **Current Employment**:\n‚Ä¢ **Company**: {employment.employer}\n‚Ä¢ **Position**: {employment.jobTitle}\n‚Ä¢ **Duties**: {employment.jobDescription}\n\n‚úÖ **Field Relationship Requirements**:\n‚Ä¢ Job must be directly related to your field of study\n‚Ä¢ Skills and knowledge from degree must be utilized\n‚Ä¢ Position should advance career goals in your field\n‚Ä¢ Part-time work (20+ hours/week) acceptable\n\nüìã **Documentation to Maintain**:\n‚Ä¢ Job description highlighting field relationship\n‚Ä¢ Letter from employer explaining connection\n‚Ä¢ Performance reviews showing skill utilization\n‚Ä¢ Training records in your field\n\n‚ö†Ô∏è **Non-Compliant Work**:\n‚Ä¢ Generic labor positions\n‚Ä¢ Unrelated service jobs\n‚Ä¢ Work requiring no specialized knowledge\n‚Ä¢ Employment outside degree field\n\nüë§ **DSO Guidance**: Consult if unsure about relationship",
        "category": "employment",
        "priority": "medium",
        "dueDateConfig": {
          "type": "relative",
          "baseDate": "dates.employmentStartDate",
          "offset": "+30days"
        }
      },
      "isActive": true,
      "tags": ["employment", "field-relationship", "compliance"],
      "version": "1.0"
    },
    {
      "id": "opt-employer-change-reporting",
      "name": "Report Employer Changes",
      "description": "Job changes during OPT must be reported within 10 days",
      "ruleGroup": "reporting",
      "phase": ["opt_active"],
      "visaTypes": ["OPT"],
      "priority": 85,
      "conditions": [
        {
          "field": "employment.employerChanged",
          "operator": "equals",
          "value": true,
          "logicOperator": "AND"
        },
        {
          "field": "employment.changeReportedToDSO",
          "operator": "equals",
          "value": false
        }
      ],
      "taskTemplate": {
        "titleTemplate": "üì¢ Report Employer Change to DSO",
        "descriptionTemplate": "You changed employers during OPT. Report this change within 10 days to maintain status.\n\nüîÑ **Employment Change**:\n‚Ä¢ **Previous**: {employment.previousEmployer}\n‚Ä¢ **Current**: {employment.employer}\n‚Ä¢ **Change Date**: {dates.employerChangeDate}\n\nüìã **Required Reporting**:\n‚Ä¢ New employer information\n‚Ä¢ Job title and responsibilities\n‚Ä¢ Start date with new employer\n‚Ä¢ End date with previous employer\n‚Ä¢ Reason for change\n\nüìÑ **Documents Needed**:\n‚Ä¢ New offer letter\n‚Ä¢ Employment verification\n‚Ä¢ Last pay stub from previous employer\n‚Ä¢ Resignation letter (if applicable)\n\nüë§ **Report To**: {user.academic.dsoContact.name}\nüìß **Email**: {user.academic.dsoContact.email}\n\n‚ö†Ô∏è **Important**: Gaps in employment count toward unemployment days\n\n‚è∞ **Deadline**: 10 days from employer change\nüèõÔ∏è **Regulation**: 8 CFR 214.2(f)(10)(ii)(D)",
        "category": "reporting",
        "priority": "high",
        "dueDateConfig": {
          "type": "relative",
          "baseDate": "dates.employerChangeDate",
          "offset": "+10days"
        }
      },
      "isActive": true,
      "tags": ["employer-change", "reporting", "dso"],
      "version": "1.0"
    },
    {
      "id": "opt-tax-obligations",
      "name": "Understand OPT Tax Obligations",
      "description": "OPT students have specific tax filing requirements",
      "ruleGroup": "reporting",
      "phase": ["opt_active"],
      "visaTypes": ["OPT"],
      "priority": 40,
      "conditions": [
        {
          "field": "dates.taxFilingDue",
          "operator": "lessThan",
          "timeValue": "60days",
          "logicOperator": "AND"
        },
        {
          "field": "financial.taxEducationCompleted",
          "operator": "equals",
          "value": false
        }
      ],
      "taskTemplate": {
        "titleTemplate": "üí∞ Understand Your OPT Tax Obligations",
        "descriptionTemplate": "Tax season is approaching. Understand your filing requirements as an OPT student.\n\nüìä **Your Tax Status**:\n‚Ä¢ **Visa Type**: F1 on OPT\n‚Ä¢ **Tax Year**: {dates.currentTaxYear}\n‚Ä¢ **Filing Deadline**: {dates.taxFilingDue}\n‚Ä¢ **Estimated Income**: {financial.annualIncome}\n\nüìã **Key Tax Considerations**:\n‚Ä¢ Generally considered \"non-resident alien\"\n‚Ä¢ May be exempt from Social Security/Medicare taxes\n‚Ä¢ Must file Form 1040NR or 1040NR-EZ\n‚Ä¢ State tax obligations vary by state\n\nüìÑ **Required Forms**:\n‚Ä¢ Form 1040NR (Federal)\n‚Ä¢ Form 8843 (all F1 students)\n‚Ä¢ W-2 from employer(s)\n‚Ä¢ State forms if required\n\nüí° **Tax Benefits**:\n‚Ä¢ Standard deduction available\n‚Ä¢ Treaty benefits (if applicable)\n‚Ä¢ Education credits may apply\n\nüîç **Resources**:\n‚Ä¢ IRS Publication 519\n‚Ä¢ University tax workshops\n‚Ä¢ VITA (Volunteer Income Tax Assistance)\n‚Ä¢ Professional tax preparers familiar with non-resident taxes\n\n‚ö†Ô∏è **Deadline**: April 15, {dates.currentTaxYear + 1}",
        "category": "financial",
        "priority": "medium",
        "dueDateConfig": {
          "type": "fixed",
          "baseDate": "2025-04-15"
        }
      },
      "isActive": true,
      "tags": ["taxes", "financial", "obligations"],
      "version": "1.0"
    }
  ]
}
